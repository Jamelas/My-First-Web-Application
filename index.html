<!doctype html>
<html lang="en">
  <head>
    <title>Psychological Profiling</title>
  </head>

<!-- Javascript here or put in a separate .js file -->
  <script>
    function fetchForm() {
      window.open("/form", "", "toolbar=no");
    }


    function viewInput() {
      if (document.getElementById("userInput").style.display === "none") {
        const xmlhttp = new XMLHttpRequest();
        xmlhttp.onload = function () {
          data = JSON.parse(this.responseText);
          document.getElementById("name").innerHTML = data["name"];
          document.getElementById("gender").innerHTML = data["gender"];
          document.getElementById("birthyear").innerHTML = data["birthyear"];
          document.getElementById("birthplace").innerHTML = data["birthplace"];
          document.getElementById("residence").innerHTML = data["residence"];

          for (let i = 1; i <= 20; i++) {
            const question = document.getElementById(`q${i}`);
            const answer = data["question"][i];
            question.innerHTML += "[" + answer + "]";
          }

          document.getElementById("job").innerHTML = data["job"];
          document.getElementById("pets").innerHTML = data["pets"];
          document.getElementById("message").innerHTML = data["message"];

        }
        xmlhttp.open("GET", "view/input", true);
        xmlhttp.send();
        document.getElementById("userInput").style.display = "block";
      }

      else {
        document.getElementById("name").innerHTML = "";
          document.getElementById("gender").innerHTML = "";
          document.getElementById("birthyear").innerHTML = "";
          document.getElementById("birthplace").innerHTML = "";
          document.getElementById("residence").innerHTML = "";

          for (let i = 1; i <= 20; i++) {
            const question = document.getElementById(`q${i}`);
            question.innerHTML = "";
          }

          document.getElementById("job").innerHTML = "";
          document.getElementById("pets").innerHTML = "";
          document.getElementById("message").innerHTML = "";
          document.getElementById("userInput").style.display = "none";
      }
    }


    function viewProfile() {
      if (document.getElementById("userProfile").style.display === "none") {
        const xmlhttp = new XMLHttpRequest();
        xmlhttp.onload = function() {
          data = JSON.parse(this.responseText);
          document.getElementById("psyc").innerHTML = data["psycho"]["psyc_index"];
          document.getElementById("desiredJob").innerHTML = data["career"]["desired"];
          document.getElementById("suitability").innerHTML = data["career"]["suitability"];

          document.getElementById("movieTitle").innerHTML = data["movies"]["title"];
          document.getElementById("movieYear").innerHTML = data["movies"]["year"];
          document.getElementById("movieRuntime").innerHTML = data["movies"]["runtime"];
          document.getElementById("movieGenre").innerHTML = data["movies"]["genre"];
          document.getElementById("movieDirector").innerHTML = data["movies"]["director"];
          document.getElementById("movieActors").innerHTML = data["movies"]["actors"];
          document.getElementById("movieRating").innerHTML = data["movies"]["rating"];


      }
      xmlhttp.open("GET", "view/profile", true);
      xmlhttp.send();
      document.getElementById("userProfile").style.display = "block";
    }

    else {
      document.getElementById("psyc").innerHTML = "";
      document.getElementById("desiredJob").innerHTML = "";
      document.getElementById("suitability").innerHTML = "";

      document.getElementById("movieTitle").innerHTML = "";
      document.getElementById("movieYear").innerHTML = "";
      document.getElementById("movieRuntime").innerHTML = "";
      document.getElementById("movieGenre").innerHTML = "";
      document.getElementById("movieDirector").innerHTML = "";
      document.getElementById("movieActors").innerHTML = "";
      document.getElementById("movieRating").innerHTML = "";

      document.getElementById("petCanvas").innerHTML = "";

      document.getElementById("userProfile").style.display = "none";
      }
    }
  </script>

  <body>

    <h1>Psychological Profiling</h1>

    <p>Welcome to your psychological profile</p>

    <br/>
    <button type="button" onclick="fetchForm()">Fetch form</button>
    <br/><br/>
    <button type="button" onclick="viewInput()">View input</button>
    <br/><br/>
    <button type="button" onclick="viewProfile()">View psychological profile</button>


    <div id="userInput" style="display: none">
      <br />
      <br />
      <h2><b>User Profile</b></h2>
      <p>Name: <span id="name"></span></p>
      <p>Gender: <span id="gender"></span></p>
      <p>Year of birth: <span id="birthyear"></span></p>
      <p>Country of birth: <span id="birthplace"></span></p>
      <p>Current country of residence: <span id="residence"></span></p>
      <hr />
      <h3>I see myself as someone who...</h3>
      <p><i>Disagree [1] ..... [5] Agree</i></p>
      <ol>
      <li>... is talkative: <span id="q1"></span></li>
      <li>... does a thorough job: <span id="q2"></span></li>
      <li>... is original, comes up with new ideas: <span id="q3"></span></li>
      <li>... is helpful, unselfish with others: <span id="q4"></span></li>
      <li>... can be somewhat careless: <span id="q5"></span></li>
      <li>... is relaxed, handles stress well: <span id="q6"></span></li>
      <li>... is curious about many things: <span id="q7"></span></li>
      <li>... is full of energy: <span id="q8"></span></li>
      <li>... starts quarrels with others: <span id="q9"></span></li>
      <li>... is a reliable worker: <span id="q10"></span></li>
      <li>... is a deep thinker: <span id="q11"></span></li>
      <li>... tends to be disorganized: <span id="q12"></span></li>
      <li>... worries a lot: <span id="q13"></span></li>
      <li>... tends to be quiet: <span id="q14"></span></li>
      <li>... tends to be lazy: <span id="q15"></span></li>
      <li>... sometimes shy: <span id="q16"></span></li>
      <li>... is sometimes rude to others: <span id="q17"></span></li>
      <li>... tends to find fault with others: <span id="q18"></span></li>
      <li>... gets nervous easily: <span id="q19"></span></li>
      <li>... likes to work in a team: <span id="q20"></span></li>
      </ol>
      <hr />
      <p>The job most appealing is: <span id="job"></span></p>
      <p>Pets that are appealing are: <span id="pets"></span></p>
      <p>Message: <span id="message"></span></p>
      <hr />
    </div>

   <div id="userProfile" style="display: none">
    <p>Psyc score: <span id="psyc"></span></p>
    <br />
    <p>Desired job: <span id="desiredJob"></span></p>
    <p>Suitability: <span id="suitability"></span></p>
    <br />
    <p>You may enjoy this movie: </p>
     <ul>
       <li>Title: <span id="movieTitle"></span></li>
       <li>Year: <span id="movieYear"></span></li>
       <li>Runtime: <span id="movieRuntime"></span></li>
       <li>Genre: <span id="movieGenre"></span></li>
       <li>Director: <span id="movieDirector"></span></li>
       <li>Actors: <span id="movieActors"></span></li>
       <li>Rating: <span id="movieRating"></span></li>
     </ul>
    <hr />
    <canvas id="petCanvas"></canvas>
  </div>

  </body>
</html>